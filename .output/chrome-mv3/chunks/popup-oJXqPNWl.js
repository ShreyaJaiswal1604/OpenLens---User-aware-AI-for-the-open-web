import{r as x,j as e,b as C,R as F,a as H}from"./global-BmMTH68k.js";async function K(){const a=navigator.hardwareConcurrency||0,l=navigator.deviceMemory||0;let n="unknown",r="unknown",t=0;try{if("gpu"in navigator){const m=await navigator.gpu.requestAdapter();if(m){const o=m.info||await m.requestAdapterInfo?.()||{};n=o.vendor||"unknown",r=o.device||o.description||"unknown";const i=m.limits?.maxBufferSize;i&&(t=Math.round(i/1024**3*10)/10)}}}catch{}let c=0;try{const m=await navigator.storage.estimate();c=Math.round((m.quota||0)/1024**3*10)/10}catch{}return{cpuCores:a,ramGB:l,gpuVendor:n,gpuDevice:r,vramEstimateGB:t,storageAvailableGB:c}}function W(a){return a.cpuCores>=2&&(a.ramGB>=4||a.vramEstimateGB>=4)}const w={ollama:{name:"Ollama (Local)",icon:"üü¢",isLocal:!0,defaultModels:[]},openai:{name:"OpenAI",icon:"üí¨",isLocal:!1,modelsUrl:"https://api.openai.com/v1/models",defaultModels:["gpt-4o","gpt-4o-mini","gpt-4.1-nano"]},anthropic:{name:"Anthropic",icon:"üß†",isLocal:!1,defaultModels:["claude-sonnet-4-5-20250929","claude-haiku-4-5-20251001"]},openrouter:{name:"OpenRouter",icon:"üåê",isLocal:!1,modelsUrl:"https://openrouter.ai/api/v1/models",defaultModels:["meta-llama/llama-3.1-8b-instruct:free","mistralai/mistral-7b-instruct:free","google/gemma-2-9b-it:free"]}},G=[{id:"phi3:mini",name:"Phi-3 Mini",family:"Phi",parameterSize:"3.8B",sizeGB:2.3,vramNeeded:4.5,contextLength:4096,license:"MIT",licenseType:"open",description:"Microsoft's compact model ‚Äî great for constrained hardware",pullCommand:"ollama pull phi3:mini"},{id:"gemma2:2b",name:"Gemma 2 2B",family:"Gemma",parameterSize:"2B",sizeGB:1.6,vramNeeded:3.5,contextLength:8192,license:"Gemma License",licenseType:"restricted",description:"Google's lightweight model ‚Äî fast and efficient",pullCommand:"ollama pull gemma2:2b"},{id:"qwen2.5:3b",name:"Qwen 2.5 3B",family:"Qwen",parameterSize:"3B",sizeGB:1.9,vramNeeded:4,contextLength:32768,license:"Apache 2.0",licenseType:"open",description:"Alibaba's model ‚Äî impressive for its size, huge context window",pullCommand:"ollama pull qwen2.5:3b"},{id:"llama3.1:8b",name:"Llama 3.1 8B",family:"Llama",parameterSize:"8B",sizeGB:4.7,vramNeeded:7,contextLength:8192,license:"Llama 3.1 Community",licenseType:"restricted",description:"Meta's flagship ‚Äî best all-rounder at this size",pullCommand:"ollama pull llama3.1:8b"},{id:"mistral:7b",name:"Mistral 7B",family:"Mistral",parameterSize:"7B",sizeGB:4.1,vramNeeded:6.5,contextLength:8192,license:"Apache 2.0",licenseType:"open",description:"Mistral AI ‚Äî fully open, strong reasoning",pullCommand:"ollama pull mistral:7b"},{id:"gemma2:9b",name:"Gemma 2 9B",family:"Gemma",parameterSize:"9B",sizeGB:5.4,vramNeeded:7.5,contextLength:8192,license:"Gemma License",licenseType:"restricted",description:"Google's mid-range ‚Äî strong instruction following",pullCommand:"ollama pull gemma2:9b"},{id:"qwen2.5:7b",name:"Qwen 2.5 7B",family:"Qwen",parameterSize:"7B",sizeGB:4.4,vramNeeded:6.5,contextLength:32768,license:"Apache 2.0",licenseType:"open",description:"Alibaba's 7B ‚Äî Apache licensed, massive context",pullCommand:"ollama pull qwen2.5:7b"},{id:"deepseek-r1:8b",name:"DeepSeek R1 8B",family:"DeepSeek",parameterSize:"8B",sizeGB:4.9,vramNeeded:7,contextLength:8192,license:"MIT",licenseType:"open",description:"DeepSeek's reasoning model ‚Äî strong at structured tasks",pullCommand:"ollama pull deepseek-r1:8b"},{id:"llama3.1:13b",name:"Llama 3.1 13B",family:"Llama",parameterSize:"13B",sizeGB:7.4,vramNeeded:10,contextLength:8192,license:"Llama 3.1 Community",licenseType:"restricted",description:"Meta 13B ‚Äî significantly smarter than 8B, needs more VRAM",pullCommand:"ollama pull llama3.1:13b"},{id:"mistral-nemo:12b",name:"Mistral Nemo 12B",family:"Mistral",parameterSize:"12B",sizeGB:7.1,vramNeeded:9.5,contextLength:128e3,license:"Apache 2.0",licenseType:"open",description:"Mistral + NVIDIA collab ‚Äî huge 128K context, fully open",pullCommand:"ollama pull mistral-nemo:12b"},{id:"qwen2.5:14b",name:"Qwen 2.5 14B",family:"Qwen",parameterSize:"14B",sizeGB:8.9,vramNeeded:11,contextLength:32768,license:"Apache 2.0",licenseType:"open",description:"Alibaba 14B ‚Äî excellent reasoning, Apache licensed",pullCommand:"ollama pull qwen2.5:14b"},{id:"llama3.1:70b",name:"Llama 3.1 70B",family:"Llama",parameterSize:"70B",sizeGB:40,vramNeeded:42,contextLength:8192,license:"Llama 3.1 Community",licenseType:"restricted",description:"Meta's largest open model ‚Äî near-GPT4 quality, massive hardware needed",pullCommand:"ollama pull llama3.1:70b"},{id:"deepseek-r1:70b",name:"DeepSeek R1 70B",family:"DeepSeek",parameterSize:"70B",sizeGB:42,vramNeeded:44,contextLength:8192,license:"MIT",licenseType:"open",description:"DeepSeek's flagship reasoning model ‚Äî MIT licensed",pullCommand:"ollama pull deepseek-r1:70b"}];function Q(a,l,n){const r=l>0?l:n,t=l>0?"VRAM":"RAM (CPU mode)";return r>=a.vramNeeded+2?{compatibility:"compatible",reason:`${a.sizeGB}GB model fits comfortably in ${r}GB ${t}`}:r>=a.vramNeeded?{compatibility:"tight",reason:`${a.sizeGB}GB model fits in ${r}GB ${t}, but may be slow`}:{compatibility:"incompatible",reason:`Needs ~${a.vramNeeded}GB, you have ${r}GB ${t}`}}function Y(a,l,n,r){const t=new Set(n.map(i=>i.toLowerCase())),c=G.map(i=>{const{compatibility:d,reason:s}=Q(i,a,l),u=t.has(i.id.toLowerCase())||n.some(p=>p.toLowerCase().startsWith(i.id.split(":")[0])&&i.id.split(":")[0]===p.split(":")[0]);return u?{catalog:i,installed:u,compatibility:"compatible",compatibilityReason:"Installed & running in Ollama"}:{catalog:i,installed:u,compatibility:d,compatibilityReason:s}}),m=new Set(G.map(i=>i.id.toLowerCase()));new Set(G.map(i=>i.id.split(":")[0].toLowerCase()));const o=n.filter(i=>{const d=i.toLowerCase();return!m.has(d)&&!G.some(s=>d.startsWith(s.id.split(":")[0])&&s.id.split(":")[0]===d.split(":")[0])});for(const i of o){const d=r?.find(g=>g.name===i),s=d?.sizeBytes?Math.round(d.sizeBytes/1e9*10)/10:0,u=d?.parameterSize||i.split(":")[1]||"unknown",p=d?.family||i.split(":")[0],b=`${p.charAt(0).toUpperCase()+p.slice(1)} ${u}`.replace(/:/g," "),S={id:i,name:b,family:p,parameterSize:u,sizeGB:s,vramNeeded:s+2,contextLength:8192,license:"Unknown",licenseType:"open",description:"Locally installed model",pullCommand:`ollama pull ${i}`};c.push({catalog:S,installed:!0,compatibility:"compatible",compatibilityReason:"Installed & running in Ollama"})}return c.sort((i,d)=>{if(i.installed!==d.installed)return i.installed?-1:1;const s={compatible:0,tight:1,incompatible:2};return s[i.compatibility]!==s[d.compatibility]?s[i.compatibility]-s[d.compatibility]:i.catalog.sizeGB-d.catalog.sizeGB})}const R=["scanning","model","ready"];function J({onComplete:a}){const[l,n]=x.useState("scanning"),[r,t]=x.useState(null),[c,m]=x.useState(!1),[o,i]=x.useState([]),[d,s]=x.useState([]),[u,p]=x.useState([]),[b,S]=x.useState("ollama"),[g,k]=x.useState(""),[y,z]=x.useState(""),[L,O]=x.useState(""),[P,f]=x.useState(!0);x.useEffect(()=>{_()},[]);async function _(){f(!0);const j=await K();t(j);let v=!1,A=[],M=[];const U="http://localhost:11434";try{const E=await fetch(`${U}/api/tags`,{signal:AbortSignal.timeout(3e3)});if(E.ok){v=!0;const B=(await E.json()).models||[];A=B.map(h=>h.name),M=B.map(h=>({name:h.name,sizeBytes:h.size,parameterSize:h.details?.parameter_size,family:h.details?.family}))}}catch{try{if(v=(await chrome.runtime.sendMessage({type:"CHECK_OLLAMA"}))?.running??!1,v){const B=(await chrome.runtime.sendMessage({type:"LIST_OLLAMA_MODELS"}))?.models||[];A=B.map(h=>h.name),M=B.map(h=>({name:h.name,sizeBytes:h.size,parameterSize:h.details?.parameter_size,family:h.details?.family}))}}catch{}}m(v),i(A),s(M);const V=Y(j.vramEstimateGB,j.ramGB,A,M);p(V),f(!1)}async function I(){const v={provider:b,selectedModel:b==="ollama"&&y||g,apiKey:L||void 0,ollamaEndpoint:"http://localhost:11434",hardwareProfile:r,benchmark:null,contextLength:8192,setupComplete:!0};await chrome.storage.local.set({setupConfig:v}),a()}const D=b==="ollama"?g||y.trim():g&&L.trim();return e.jsxs("div",{className:"w-[400px] min-h-[500px] bg-gray-950 text-white flex flex-col",children:[e.jsxs("div",{className:"px-4 pt-4 pb-3 border-b border-gray-800",children:[e.jsxs("h1",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"üîç"})," AgentLens Setup"]}),e.jsx("div",{className:"flex gap-1.5 mt-2",children:R.map((j,v)=>e.jsx("div",{className:`h-1 flex-1 rounded transition-all ${l===j?"bg-blue-500":v<R.indexOf(l)?"bg-blue-800":"bg-gray-800"}`},j))})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[l==="scanning"&&e.jsx(X,{hardware:r,ollamaReady:c,scanning:P,onNext:()=>n("model")}),l==="model"&&e.jsx(Z,{hardware:r,ollamaReady:c,catalogModels:u,installedModels:o,provider:b,onProviderChange:S,selectedModel:g,onSelectModel:k,customModel:y,onCustomModelChange:z,apiKey:L,onApiKeyChange:O,canFinish:!!D,onNext:()=>n("ready"),onBack:()=>n("scanning")}),l==="ready"&&e.jsx(se,{provider:b,selectedModel:y||g,catalogModels:u,onFinish:I,onBack:()=>n("model")})]})]})}function X({hardware:a,ollamaReady:l,scanning:n,onNext:r}){if(n)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-4",children:[e.jsx("div",{className:"text-4xl animate-pulse",children:"üîç"}),e.jsx("div",{className:"text-lg font-medium",children:"Scanning your hardware..."}),e.jsx("div",{className:"text-sm text-gray-400",children:"Let's see what your machine can do"})]});const t=a,c=W(t);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-2",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Hardware Scan"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Let's see what your machine can do"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(N,{icon:"‚öôÔ∏è",label:"CPU",value:`${t.cpuCores} cores`,ok:t.cpuCores>=2}),e.jsx(N,{icon:"üíª",label:"RAM",value:t.ramGB?`${t.ramGB} GB`:"N/A",ok:t.ramGB>=4}),e.jsx(N,{icon:"üéÆ",label:"GPU",value:t.gpuVendor!=="unknown"?t.gpuDevice.slice(0,20):"Not detected",ok:t.gpuVendor!=="unknown"}),e.jsx(N,{icon:"üß†",label:"VRAM",value:t.vramEstimateGB?`~${t.vramEstimateGB} GB`:"N/A",ok:t.vramEstimateGB>=4}),e.jsx(N,{icon:"üíæ",label:"Storage",value:`${t.storageAvailableGB} GB`,ok:t.storageAvailableGB>1}),e.jsx(N,{icon:"ü¶ô",label:"Ollama",value:l?"Detected":"Not found",ok:l})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center text-sm ${c?"bg-green-900/30 border border-green-800/30":"bg-yellow-900/30 border border-yellow-800/30"}`,children:[e.jsx("div",{className:`font-medium ${c?"text-green-300":"text-yellow-300"}`,children:c?"üü¢ Your machine can run AI locally.":"‚ö†Ô∏è Limited hardware ‚Äî cloud models recommended."}),c&&e.jsx("div",{className:"text-xs text-green-400/70 mt-1",children:"Your data stays on YOUR device."})]}),e.jsxs("button",{onClick:r,className:"w-full py-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium text-sm transition-colors",children:["Choose a Model ","‚Üí"]})]})}function N({icon:a,label:l,value:n,ok:r}){return e.jsxs("div",{className:"bg-gray-900 rounded-lg p-2.5 relative",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[e.jsx("span",{children:a})," ",l]}),e.jsx("div",{className:"text-sm font-medium truncate",children:n}),e.jsx("div",{className:"absolute top-2 right-2 text-xs",children:r?"‚úÖ":"‚ö™"})]})}function Z({hardware:a,ollamaReady:l,catalogModels:n,installedModels:r,provider:t,onProviderChange:c,selectedModel:m,onSelectModel:o,customModel:i,onCustomModelChange:d,apiKey:s,onApiKeyChange:u,canFinish:p,onNext:b,onBack:S}){const[g,k]=x.useState(l?"local":"cloud"),[y,z]=x.useState(!1);x.useEffect(()=>{g==="local"&&c("ollama")},[g]);const L=n.filter(f=>f.compatibility!=="incompatible"),O=n.filter(f=>f.compatibility==="incompatible"),P=y?n:L;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:S,className:"text-gray-500 hover:text-white text-sm",children:"‚Üê"}),e.jsx("h2",{className:"font-semibold text-lg",children:"Choose Your Model"})]}),e.jsxs("div",{className:"flex bg-gray-900 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>k("local"),className:`flex-1 py-1.5 rounded text-sm font-medium transition-colors ${g==="local"?"bg-green-700 text-white":"text-gray-400 hover:text-white"}`,children:["üü¢"," Local (Ollama)"]}),e.jsxs("button",{onClick:()=>k("cloud"),className:`flex-1 py-1.5 rounded text-sm font-medium transition-colors ${g==="cloud"?"bg-red-700 text-white":"text-gray-400 hover:text-white"}`,children:["‚òÅÔ∏è"," Cloud (API Key)"]})]}),g==="local"&&e.jsx(ee,{ollamaReady:l,catalogModels:P,selectedModel:m,onSelectModel:f=>{o(f),d("")},customModel:i,onCustomModelChange:f=>{d(f),o("")},showAll:y,onToggleAll:()=>z(!y),incompatibleCount:O.length}),g==="cloud"&&e.jsx(ae,{provider:t,onProviderChange:c,selectedModel:m,onSelectModel:o,apiKey:s,onApiKeyChange:u}),e.jsxs("button",{onClick:b,disabled:!p,className:"w-full py-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium text-sm disabled:opacity-40 disabled:cursor-not-allowed transition-colors",children:["Continue ","‚Üí"]})]})}function ee({ollamaReady:a,catalogModels:l,selectedModel:n,onSelectModel:r,customModel:t,onCustomModelChange:c,showAll:m,onToggleAll:o,incompatibleCount:i}){return a?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Select a model ‚Äî compatibility checked against your hardware"}),e.jsx("div",{className:"max-h-[220px] overflow-auto space-y-1.5 pr-1",children:l.map(d=>e.jsx(te,{model:d,selected:n===d.catalog.id,onSelect:()=>r(d.catalog.id)},d.catalog.id))}),i>0&&e.jsxs("button",{onClick:o,className:"text-xs text-gray-500 hover:text-gray-300",children:[m?"Hide":`Show ${i}`," incompatible models"]}),e.jsxs("div",{className:"pt-1 border-t border-gray-800",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Or enter any Ollama model name:"}),e.jsx("input",{type:"text",value:t,onChange:d=>c(d.target.value),placeholder:"e.g. codellama:7b, solar:10.7b ...",className:"w-full bg-gray-900 border border-gray-700 rounded px-3 py-2 text-sm focus:outline-none focus:border-blue-500 placeholder-gray-600"}),t&&e.jsxs("div",{className:"text-xs text-yellow-400 mt-1",children:["‚ö†Ô∏è"," Make sure this model is pulled: ",e.jsxs("code",{className:"bg-gray-900 px-1 rounded",children:["ollama pull ",t]})]})]})]}):e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-800/30 rounded-lg p-3 text-sm",children:[e.jsxs("div",{className:"font-medium text-yellow-300 mb-1",children:["‚ö†Ô∏è"," Ollama not detected"]}),e.jsx("div",{className:"text-yellow-200/80 text-xs",children:"Install Ollama for local AI processing:"}),e.jsx("code",{className:"block mt-1.5 bg-gray-900 rounded px-2 py-1 text-xs text-blue-400",children:"curl -fsSL https://ollama.com/install.sh | sh"}),e.jsx("div",{className:"text-yellow-200/80 text-xs mt-1.5",children:"Then pull a model:"}),e.jsx("code",{className:"block mt-1 bg-gray-900 rounded px-2 py-1 text-xs text-green-400",children:"ollama pull llama3.1:8b"})]})})}function te({model:a,selected:l,onSelect:n}){const r=a.catalog,t=a.compatibility,c={compatible:"‚úÖ",tight:"‚ö†Ô∏è",incompatible:"‚ùå"}[t],m={compatible:"text-green-400",tight:"text-yellow-400",incompatible:"text-red-400"}[t],o={compatible:"Compatible",tight:"Tight fit",incompatible:"Too large"}[t],i={open:"‚úÖ",restricted:"üü°","non-commercial":"üî¥"}[r.licenseType];return e.jsxs("button",{onClick:n,disabled:t==="incompatible",className:`w-full text-left p-2.5 rounded-lg transition-all ${l?"bg-blue-900/40 border border-blue-500":t==="incompatible"?"bg-gray-900/40 border border-transparent opacity-50 cursor-not-allowed":"bg-gray-900 border border-transparent hover:border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm",children:r.name}),a.installed&&e.jsx("span",{className:"text-[10px] bg-blue-900 text-blue-300 px-1.5 py-0.5 rounded",children:"installed"})]}),e.jsxs("span",{className:`text-xs ${m}`,children:[c," ",o]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-400",children:[e.jsx("span",{children:r.parameterSize}),e.jsx("span",{children:"¬∑"}),e.jsxs("span",{children:[r.sizeGB,"GB"]}),e.jsx("span",{children:"¬∑"}),e.jsxs("span",{children:[i," ",r.license]})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:a.compatibilityReason}),!a.installed&&t!=="incompatible"&&e.jsx("code",{className:"block mt-1 text-[10px] text-green-400/70 bg-gray-800 rounded px-1.5 py-0.5 w-fit",children:r.pullCommand})]})}function ae({provider:a,onProviderChange:l,selectedModel:n,onSelectModel:r,apiKey:t,onApiKeyChange:c}){const m=["openai","anthropic","openrouter"];return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-red-900/15 border border-red-800/20 rounded-lg p-2.5 text-xs text-red-300",children:["‚ö†Ô∏è"," Cloud: your data will leave your device. AgentLens will track exactly what is sent."]}),e.jsx("div",{className:"space-y-1.5",children:m.map(o=>e.jsxs("button",{onClick:()=>{l(o),r(w[o].defaultModels[0]||"")},className:`w-full text-left p-2.5 rounded-lg transition-colors ${a===o?"bg-blue-900/40 border border-blue-500":"bg-gray-900 border border-transparent hover:border-gray-700"}`,children:[e.jsxs("div",{className:"font-medium text-sm",children:[w[o].icon," ",w[o].name]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:[o==="openai"&&"GPT-4o, GPT-4o-mini",o==="anthropic"&&"Claude Sonnet, Claude Haiku",o==="openrouter"&&"200+ models (free tier available)"]})]},o))}),a!=="ollama"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"password",value:t,onChange:o=>c(o.target.value),placeholder:`${w[a].name} API key`,className:"w-full bg-gray-900 border border-gray-700 rounded px-3 py-2 text-sm focus:outline-none focus:border-blue-500"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Model"}),w[a].defaultModels.map(o=>e.jsx("button",{onClick:()=>r(o),className:`w-full text-left p-2 rounded text-sm ${n===o?"bg-blue-900/40 border border-blue-500":"bg-gray-900 border border-transparent hover:border-gray-700"}`,children:o},o)),e.jsx("input",{type:"text",value:n,onChange:o=>r(o.target.value),placeholder:"Or type a custom model ID...",className:"w-full bg-gray-900 border border-gray-700 rounded px-3 py-2 text-sm focus:outline-none focus:border-blue-500"})]})]})]})}function se({provider:a,selectedModel:l,catalogModels:n,onFinish:r,onBack:t}){const c=a==="ollama",m=n.find(o=>o.catalog.id===l);return e.jsxs("div",{className:"space-y-4 flex flex-col items-center justify-center h-full",children:[e.jsx("div",{className:"text-5xl",children:"‚úÖ"}),e.jsx("h2",{className:"font-semibold text-xl",children:"Ready to Go"}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 w-full space-y-2.5",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Provider"}),e.jsx("span",{children:c?"üü¢ Ollama (Local)":`‚òÅÔ∏è ${w[a].name}`})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Model"}),e.jsx("span",{className:"font-medium",children:l})]}),m&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Size"}),e.jsxs("span",{children:[m.catalog.sizeGB,"GB ¬∑ ",m.catalog.parameterSize]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"License"}),e.jsx("span",{children:m.catalog.license})]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Privacy"}),e.jsx("span",{className:c?"text-green-400":"text-red-400",children:c?"üü¢ Data stays on device":"üî¥ Data sent to cloud"})]})]}),e.jsx("p",{className:"text-sm text-gray-400 text-center",children:"AgentLens will monitor AI activity and show you what your AI knows about you."}),e.jsxs("button",{onClick:r,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold text-base transition-colors",children:["Start AgentLens ","üöÄ"]}),e.jsxs("button",{onClick:t,className:"text-xs text-gray-500 hover:text-gray-300",children:["‚Üê"," Change model"]})]})}function le(a){const l={};for(const n of a)l[n.category]||(l[n.category]=[]),l[n.category].push(n);return l}function ne(){const[a,l]=x.useState(null),[n,r]=x.useState(!0);x.useEffect(()=>{t();const s=u=>{u.shadowProfile&&l(u.shadowProfile.newValue)};return chrome.storage.onChanged.addListener(s),()=>chrome.storage.onChanged.removeListener(s)},[]);function t(){chrome.storage.local.get("shadowProfile",s=>{l(s?.shadowProfile||null),r(!1)})}function c(){chrome.storage.local.remove("shadowProfile",()=>{l(null)})}function m(){if(!a)return;const s=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),u=URL.createObjectURL(s),p=document.createElement("a");p.href=u,p.download=`agentlens-shadow-profile-${new Date().toISOString().slice(0,10)}.json`,p.click(),URL.revokeObjectURL(u)}function o(){r(!0),(typeof C<"u"?C.runtime.sendMessage.bind(C.runtime):chrome.runtime.sendMessage.bind(chrome.runtime))({type:"GENERATE_SHADOW_PROFILE"}).then(()=>{setTimeout(t,1e3)}).catch(()=>r(!1))}if(n)return e.jsx("div",{className:"text-gray-400 text-sm text-center py-8",children:"Loading..."});if(!a||a.inferences.length===0)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-3 text-center",children:[e.jsx("div",{className:"text-4xl",children:"üë§"}),e.jsx("h3",{className:"font-semibold text-lg",children:"No Shadow Profile Yet"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Run a task through the Agent Panel to see what your AI infers about you."}),e.jsx("button",{onClick:o,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded text-sm mt-2",children:"Generate from current session"})]});const i=le(a.inferences),d={financial:"Financial",schedule:"Schedule",preferences:"Preferences",relationships:"Relationships",habits:"Habits",work:"Work",location:"Location",health:"Health"};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["After ",a.sessionCount," session",a.sessionCount!==1?"s":"",", your AI has inferred:"]}),e.jsxs("div",{className:"text-2xl font-bold text-purple-400 mt-1",children:[a.inferences.length," data points"]})]}),Object.entries(i).map(([s,u])=>e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsxs("h4",{className:"font-semibold text-sm mb-2 flex items-center gap-2",children:[e.jsx("span",{children:u[0]?.icon}),e.jsx("span",{className:"uppercase text-xs tracking-wide text-gray-300",children:d[s]||s})]}),e.jsx("div",{className:"space-y-2",children:u.map((p,b)=>e.jsx("div",{className:"text-sm",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"‚Ä¢"}),e.jsxs("div",{children:[e.jsx("span",{children:p.inference}),e.jsxs("span",{className:`ml-2 text-xs ${p.confidence==="high"?"text-green-400":p.confidence==="medium"?"text-yellow-400":"text-gray-500"}`,children:["(",p.confidence,")"]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:["‚Ü≥"," ",p.derivedFrom.join(", ")]})]})]})},b))})]},s)),e.jsxs("div",{className:"bg-green-900/20 rounded-lg p-3 text-center text-sm text-green-300",children:["üü¢"," All inferences derived from LOCAL processing.",e.jsx("br",{}),"Nothing left your device."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:c,className:"flex-1 py-2 bg-red-900/30 hover:bg-red-900/50 text-red-300 rounded text-sm",children:["üóëÔ∏è"," Clear"]}),e.jsxs("button",{onClick:m,className:"flex-1 py-2 bg-gray-800 hover:bg-gray-700 rounded text-sm",children:["üìã"," Export"]})]})]})}const re=[{name:"read_page",description:"Extract and summarize the current page content"},{name:"extract_data",description:"Extract structured data (prices, links, forms, headings)"},{name:"find_on_page",description:"Search for specific text on the page"},{name:"navigate",description:"Open a URL in a new tab"},{name:"fill_form",description:"Fill form fields (user must submit)"},{name:"click_element",description:"Click a link or button"}],T=typeof C<"u"?C.runtime.sendMessage.bind(C.runtime):chrome.runtime.sendMessage.bind(chrome.runtime);function ie(){const[a,l]=x.useState([]),[n,r]=x.useState(!1),[t,c]=x.useState({name:"",description:"",type:"fetch_url",url:"",script:"",paramName:"",paramDesc:""});x.useEffect(()=>{m()},[]);function m(){T({type:"GET_CUSTOM_TOOLS"}).then(s=>{l(s?.tools||[])}).catch(()=>{})}async function o(){if(!t.name.trim())return;const s={};t.paramName.trim()&&(s[t.paramName.trim()]={type:"string",description:t.paramDesc||t.paramName});const u={id:`custom_${Date.now()}`,name:t.name.trim(),description:t.description.trim()||t.name.trim(),type:t.type,params:s,url:t.type==="fetch_url"?t.url:void 0,script:t.type==="page_script"?t.script:void 0,enabled:!0};await T({type:"SAVE_CUSTOM_TOOL",tool:u}),c({name:"",description:"",type:"fetch_url",url:"",script:"",paramName:"",paramDesc:""}),r(!1),m()}async function i(s){await T({type:"DELETE_CUSTOM_TOOL",toolId:s}),m()}async function d(s){await T({type:"SAVE_CUSTOM_TOOL",tool:{...s,enabled:!s.enabled}}),m()}return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:"Built-in Tools (6)"}),e.jsx("div",{className:"space-y-1",children:re.map(s=>e.jsxs("div",{className:"flex items-center gap-2 text-xs py-1.5 px-2 bg-gray-900/50 rounded",children:[e.jsx("span",{className:"text-green-400",children:"‚úÖ"}),e.jsx("span",{className:"font-medium text-gray-300",children:s.name}),e.jsx("span",{className:"text-gray-500 truncate",children:s.description})]},s.name))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:["Custom Tools (",a.length,")"]}),e.jsx("button",{onClick:()=>r(!n),className:"text-xs px-2 py-1 bg-blue-600 hover:bg-blue-700 rounded",children:n?"Cancel":"+ Add Tool"})]}),n&&e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 space-y-2 mb-3 border border-gray-700",children:[e.jsx("input",{placeholder:"Tool name (e.g. get_weather)",value:t.name,onChange:s=>c({...t,name:s.target.value}),className:"w-full bg-gray-800 border border-gray-700 rounded px-2 py-1.5 text-sm focus:outline-none focus:border-blue-500"}),e.jsx("input",{placeholder:"Description",value:t.description,onChange:s=>c({...t,description:s.target.value}),className:"w-full bg-gray-800 border border-gray-700 rounded px-2 py-1.5 text-sm focus:outline-none focus:border-blue-500"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c({...t,type:"fetch_url"}),className:`flex-1 py-1 rounded text-xs ${t.type==="fetch_url"?"bg-blue-600":"bg-gray-800"}`,children:"Fetch URL"}),e.jsx("button",{onClick:()=>c({...t,type:"page_script"}),className:`flex-1 py-1 rounded text-xs ${t.type==="page_script"?"bg-blue-600":"bg-gray-800"}`,children:"Page Script"})]}),t.type==="fetch_url"&&e.jsx("input",{placeholder:"URL template (e.g. https://api.example.com/search?q={query})",value:t.url,onChange:s=>c({...t,url:s.target.value}),className:"w-full bg-gray-800 border border-gray-700 rounded px-2 py-1.5 text-xs focus:outline-none focus:border-blue-500"}),t.type==="page_script"&&e.jsx("textarea",{placeholder:"JavaScript to run on page (use {param} for substitution)",value:t.script,onChange:s=>c({...t,script:s.target.value}),className:"w-full h-16 bg-gray-800 border border-gray-700 rounded px-2 py-1.5 text-xs resize-none focus:outline-none focus:border-blue-500 font-mono"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{placeholder:"Param name (e.g. query)",value:t.paramName,onChange:s=>c({...t,paramName:s.target.value}),className:"flex-1 bg-gray-800 border border-gray-700 rounded px-2 py-1.5 text-xs focus:outline-none focus:border-blue-500"}),e.jsx("input",{placeholder:"Param description",value:t.paramDesc,onChange:s=>c({...t,paramDesc:s.target.value}),className:"flex-1 bg-gray-800 border border-gray-700 rounded px-2 py-1.5 text-xs focus:outline-none focus:border-blue-500"})]}),e.jsx("button",{onClick:o,className:"w-full py-1.5 bg-green-600 hover:bg-green-700 rounded text-sm font-medium",children:"Save Tool"})]}),a.length===0&&!n&&e.jsx("div",{className:"text-xs text-gray-500 text-center py-4",children:"No custom tools yet. Add one to extend your AI's capabilities."}),a.map(s=>e.jsxs("div",{className:"flex items-center gap-2 text-xs py-1.5 px-2 bg-gray-900 rounded mb-1",children:[e.jsx("button",{onClick:()=>d(s),className:`shrink-0 ${s.enabled?"text-green-400":"text-gray-600"}`,children:s.enabled?"‚úÖ":"‚ö™"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("span",{className:"font-medium text-gray-300",children:s.name}),e.jsxs("span",{className:"ml-1 text-gray-600",children:["(",s.type,")"]}),e.jsx("div",{className:"text-gray-500 truncate",children:s.description})]}),e.jsx("button",{onClick:()=>i(s.id),className:"shrink-0 text-red-400 hover:text-red-300",children:"üóëÔ∏è"})]},s.id))]})]})}function oe(){const[a,l]=x.useState("loading");return x.useEffect(()=>{chrome.storage.local.get("setupConfig",n=>{n.setupConfig?.setupComplete?l("main"):l("setup")})},[]),a==="loading"?e.jsx("div",{className:"w-[400px] h-[500px] bg-gray-950 text-white flex items-center justify-center",children:e.jsx("div",{className:"text-lg animate-pulse",children:"Loading..."})}):a==="setup"?e.jsx(J,{onComplete:()=>l("main")}):e.jsx(ce,{})}function ce(){const[a,l]=x.useState("dashboard");return e.jsxs("div",{className:"w-[400px] h-[500px] bg-gray-950 text-white flex flex-col",children:[e.jsxs("div",{className:"px-4 pt-4 pb-2 border-b border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"üîç"})," AgentLens"]}),e.jsx("button",{onClick:()=>{chrome.storage.local.remove("setupConfig"),window.location.reload()},className:"text-xs text-gray-500 hover:text-gray-300",children:"Reset"})]}),e.jsxs("div",{className:"flex gap-1 mt-3",children:[e.jsx("button",{onClick:()=>l("dashboard"),className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${a==="dashboard"?"bg-blue-600 text-white":"text-gray-400 hover:text-white"}`,children:"Dashboard"}),e.jsxs("button",{onClick:()=>l("shadow"),className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${a==="shadow"?"bg-purple-600 text-white":"text-gray-400 hover:text-white"}`,children:["üë§"," Shadow Profile"]}),e.jsxs("button",{onClick:()=>l("tools"),className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${a==="tools"?"bg-green-600 text-white":"text-gray-400 hover:text-white"}`,children:["üîß"," Tools"]})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:a==="dashboard"?e.jsx(de,{}):a==="shadow"?e.jsx(ne,{}):e.jsx(ie,{})})]})}function de(){const[a,l]=x.useState(null),[n,r]=x.useState(null);x.useEffect(()=>{chrome.storage.local.get(["setupConfig","sessionState"],d=>{l(d.setupConfig),r(d.sessionState)});const i=d=>{d.sessionState&&r(d.sessionState.newValue)};return chrome.storage.onChanged.addListener(i),()=>chrome.storage.onChanged.removeListener(i)},[]);const t=a?.hardwareProfile,c=n?.totalTokens||0,m=n?.auditEvents?.length||0,o=n?Math.round(n.contextUsed/n.contextLimit*100):0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Active Model"}),e.jsx("div",{className:"font-semibold",children:a?.selectedModel||"None"}),e.jsx("div",{className:`text-xs mt-1 ${a?.provider==="ollama"?"text-green-400":"text-red-400"}`,children:a?.provider==="ollama"?"üü¢ Local processing":`üî¥ Cloud ‚Äî ${a?.provider||"unknown"}`})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx($,{label:"Tokens",value:c.toLocaleString(),icon:"üìä"}),e.jsx($,{label:"Context",value:`${o}%`,icon:"üß†",color:o>90?"red":o>70?"yellow":"green"}),e.jsx($,{label:"Events",value:String(m),icon:"üìã"})]}),t&&e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Hardware"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-xs",children:[e.jsxs("div",{children:["CPU: ",t.cpuCores," cores"]}),e.jsxs("div",{children:["RAM: ",t.ramGB,"GB"]}),e.jsxs("div",{children:["GPU: ",t.gpuVendor]}),e.jsxs("div",{children:["Storage: ",t.storageAvailableGB,"GB"]})]})]}),e.jsxs("button",{onClick:()=>{chrome.runtime.sendMessage({type:"OPEN_SIDEPANEL"})},className:"w-full py-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium text-sm transition-colors",children:["ü§ñ"," Open Agent Panel"]})]})}function $({label:a,value:l,icon:n,color:r="blue"}){const t={blue:"text-blue-400",green:"text-green-400",yellow:"text-yellow-400",red:"text-red-400"};return e.jsxs("div",{className:"bg-gray-900 rounded-lg p-2.5 text-center",children:[e.jsx("div",{className:"text-lg",children:n}),e.jsx("div",{className:`font-bold text-lg ${t[r]||t.blue}`,children:l}),e.jsx("div",{className:"text-xs text-gray-400",children:a})]})}F.createRoot(document.getElementById("root")).render(e.jsx(H.StrictMode,{children:e.jsx(oe,{})}));
