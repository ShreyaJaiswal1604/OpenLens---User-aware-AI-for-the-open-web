import{r as u,j as e,b as L,R as F,a as K}from"./global-BS6jmjxD.js";async function W(){const t=navigator.hardwareConcurrency||0,s=navigator.deviceMemory||0;let n="unknown",l="unknown",a=0;try{if("gpu"in navigator){const x=await navigator.gpu.requestAdapter();if(x){const r=x.info||await x.requestAdapterInfo?.()||{};n=r.vendor||"unknown",l=r.device||r.description||"unknown";const o=x.limits?.maxBufferSize;o&&(a=Math.round(o/1024**3*10)/10)}}}catch{}let d=0;try{const x=await navigator.storage.estimate();d=Math.round((x.quota||0)/1024**3*10)/10}catch{}return{cpuCores:t,ramGB:s,gpuVendor:n,gpuDevice:l,vramEstimateGB:a,storageAvailableGB:d}}function Q(t){return t.cpuCores>=2&&(t.ramGB>=4||t.vramEstimateGB>=4)}const S={ollama:{name:"Ollama (Local)",icon:"ðŸŸ¢",isLocal:!0,defaultModels:[]},openai:{name:"OpenAI",icon:"ðŸ’¬",isLocal:!1,modelsUrl:"https://api.openai.com/v1/models",defaultModels:["gpt-4o","gpt-4o-mini","gpt-4.1-nano"]},anthropic:{name:"Anthropic",icon:"ðŸ§ ",isLocal:!1,defaultModels:["claude-sonnet-4-5-20250929","claude-haiku-4-5-20251001"]},openrouter:{name:"OpenRouter",icon:"ðŸŒ",isLocal:!1,modelsUrl:"https://openrouter.ai/api/v1/models",defaultModels:["meta-llama/llama-3.1-8b-instruct:free","mistralai/mistral-7b-instruct:free","google/gemma-2-9b-it:free"]}},E=[{id:"phi3:mini",name:"Phi-3 Mini",family:"Phi",parameterSize:"3.8B",sizeGB:2.3,vramNeeded:4.5,contextLength:4096,license:"MIT",licenseType:"open",description:"Microsoft's compact model â€” great for constrained hardware",pullCommand:"ollama pull phi3:mini"},{id:"gemma2:2b",name:"Gemma 2 2B",family:"Gemma",parameterSize:"2B",sizeGB:1.6,vramNeeded:3.5,contextLength:8192,license:"Gemma License",licenseType:"restricted",description:"Google's lightweight model â€” fast and efficient",pullCommand:"ollama pull gemma2:2b"},{id:"qwen2.5:3b",name:"Qwen 2.5 3B",family:"Qwen",parameterSize:"3B",sizeGB:1.9,vramNeeded:4,contextLength:32768,license:"Apache 2.0",licenseType:"open",description:"Alibaba's model â€” impressive for its size, huge context window",pullCommand:"ollama pull qwen2.5:3b"},{id:"llama3.1:8b",name:"Llama 3.1 8B",family:"Llama",parameterSize:"8B",sizeGB:4.7,vramNeeded:7,contextLength:8192,license:"Llama 3.1 Community",licenseType:"restricted",description:"Meta's flagship â€” best all-rounder at this size",pullCommand:"ollama pull llama3.1:8b"},{id:"mistral:7b",name:"Mistral 7B",family:"Mistral",parameterSize:"7B",sizeGB:4.1,vramNeeded:6.5,contextLength:8192,license:"Apache 2.0",licenseType:"open",description:"Mistral AI â€” fully open, strong reasoning",pullCommand:"ollama pull mistral:7b"},{id:"gemma2:9b",name:"Gemma 2 9B",family:"Gemma",parameterSize:"9B",sizeGB:5.4,vramNeeded:7.5,contextLength:8192,license:"Gemma License",licenseType:"restricted",description:"Google's mid-range â€” strong instruction following",pullCommand:"ollama pull gemma2:9b"},{id:"qwen2.5:7b",name:"Qwen 2.5 7B",family:"Qwen",parameterSize:"7B",sizeGB:4.4,vramNeeded:6.5,contextLength:32768,license:"Apache 2.0",licenseType:"open",description:"Alibaba's 7B â€” Apache licensed, massive context",pullCommand:"ollama pull qwen2.5:7b"},{id:"deepseek-r1:8b",name:"DeepSeek R1 8B",family:"DeepSeek",parameterSize:"8B",sizeGB:4.9,vramNeeded:7,contextLength:8192,license:"MIT",licenseType:"open",description:"DeepSeek's reasoning model â€” strong at structured tasks",pullCommand:"ollama pull deepseek-r1:8b"},{id:"llama3.1:13b",name:"Llama 3.1 13B",family:"Llama",parameterSize:"13B",sizeGB:7.4,vramNeeded:10,contextLength:8192,license:"Llama 3.1 Community",licenseType:"restricted",description:"Meta 13B â€” significantly smarter than 8B, needs more VRAM",pullCommand:"ollama pull llama3.1:13b"},{id:"mistral-nemo:12b",name:"Mistral Nemo 12B",family:"Mistral",parameterSize:"12B",sizeGB:7.1,vramNeeded:9.5,contextLength:128e3,license:"Apache 2.0",licenseType:"open",description:"Mistral + NVIDIA collab â€” huge 128K context, fully open",pullCommand:"ollama pull mistral-nemo:12b"},{id:"qwen2.5:14b",name:"Qwen 2.5 14B",family:"Qwen",parameterSize:"14B",sizeGB:8.9,vramNeeded:11,contextLength:32768,license:"Apache 2.0",licenseType:"open",description:"Alibaba 14B â€” excellent reasoning, Apache licensed",pullCommand:"ollama pull qwen2.5:14b"},{id:"llama3.1:70b",name:"Llama 3.1 70B",family:"Llama",parameterSize:"70B",sizeGB:40,vramNeeded:42,contextLength:8192,license:"Llama 3.1 Community",licenseType:"restricted",description:"Meta's largest open model â€” near-GPT4 quality, massive hardware needed",pullCommand:"ollama pull llama3.1:70b"},{id:"deepseek-r1:70b",name:"DeepSeek R1 70B",family:"DeepSeek",parameterSize:"70B",sizeGB:42,vramNeeded:44,contextLength:8192,license:"MIT",licenseType:"open",description:"DeepSeek's flagship reasoning model â€” MIT licensed",pullCommand:"ollama pull deepseek-r1:70b"}];function Y(t,s,n){const l=s>0?s:n,a=s>0?"VRAM":"RAM (CPU mode)";return l>=t.vramNeeded+2?{compatibility:"compatible",reason:`${t.sizeGB}GB model fits comfortably in ${l}GB ${a}`}:l>=t.vramNeeded?{compatibility:"tight",reason:`${t.sizeGB}GB model fits in ${l}GB ${a}, but may be slow`}:{compatibility:"incompatible",reason:`Needs ~${t.vramNeeded}GB, you have ${l}GB ${a}`}}function J(t,s,n,l){const a=new Set(n.map(o=>o.toLowerCase())),d=E.map(o=>{const{compatibility:c,reason:m}=Y(o,t,s),p=a.has(o.id.toLowerCase())||n.some(h=>h.toLowerCase().startsWith(o.id.split(":")[0])&&o.id.split(":")[0]===h.split(":")[0]);return p?{catalog:o,installed:p,compatibility:"compatible",compatibilityReason:"Installed & running in Ollama"}:{catalog:o,installed:p,compatibility:c,compatibilityReason:m}}),x=new Set(E.map(o=>o.id.toLowerCase()));new Set(E.map(o=>o.id.split(":")[0].toLowerCase()));const r=n.filter(o=>{const c=o.toLowerCase();return!x.has(c)&&!E.some(m=>c.startsWith(m.id.split(":")[0])&&m.id.split(":")[0]===c.split(":")[0])});for(const o of r){const c=l?.find(i=>i.name===o),m=c?.sizeBytes?Math.round(c.sizeBytes/1e9*10)/10:0,p=c?.parameterSize||o.split(":")[1]||"unknown",h=c?.family||o.split(":")[0],g=`${h.charAt(0).toUpperCase()+h.slice(1)} ${p}`.replace(/:/g," "),j={id:o,name:g,family:h,parameterSize:p,sizeGB:m,vramNeeded:m+2,contextLength:8192,license:"Unknown",licenseType:"open",description:"Locally installed model",pullCommand:`ollama pull ${o}`};d.push({catalog:j,installed:!0,compatibility:"compatible",compatibilityReason:"Installed & running in Ollama"})}return d.sort((o,c)=>{if(o.installed!==c.installed)return o.installed?-1:1;const m={compatible:0,tight:1,incompatible:2};return m[o.compatibility]!==m[c.compatibility]?m[o.compatibility]-m[c.compatibility]:o.catalog.sizeGB-c.catalog.sizeGB})}function X(t){const s=new URL(t);return`${s.protocol}//${s.host}/*`}function B(t){return new Promise(s=>{try{const n=X(t);chrome.permissions.request({origins:[n]},l=>{s(l??!1)})}catch{s(!1)}})}const I=["scanning","model","ready"];function Z({onComplete:t}){const[s,n]=u.useState("scanning"),[l,a]=u.useState(null),[d,x]=u.useState(!1),[r,o]=u.useState([]),[c,m]=u.useState([]),[p,h]=u.useState([]),[g,j]=u.useState("ollama"),[i,b]=u.useState(""),[v,z]=u.useState(""),[k,T]=u.useState(""),[R,y]=u.useState(!0);u.useEffect(()=>{D()},[]);async function D(){y(!0);const N=await W();a(N),await B("http://localhost:11434");let w=!1,G=[],A=[];const V="http://localhost:11434";try{const O=await fetch(`${V}/api/tags`,{signal:AbortSignal.timeout(3e3)});if(O.ok){w=!0;const M=(await O.json()).models||[];G=M.map(f=>f.name),A=M.map(f=>({name:f.name,sizeBytes:f.size,parameterSize:f.details?.parameter_size,family:f.details?.family}))}}catch{try{if(w=(await chrome.runtime.sendMessage({type:"CHECK_OLLAMA"}))?.running??!1,w){const M=(await chrome.runtime.sendMessage({type:"LIST_OLLAMA_MODELS"}))?.models||[];G=M.map(f=>f.name),A=M.map(f=>({name:f.name,sizeBytes:f.size,parameterSize:f.details?.parameter_size,family:f.details?.family}))}}catch{}}x(w),o(G),m(A);const q=J(N.vramEstimateGB,N.ramGB,G,A);h(q),y(!1)}async function _(){const N=g==="ollama"&&v||i;g==="ollama"?await B("http://localhost:11434"):g==="openai"?await B("https://api.openai.com"):g==="anthropic"?await B("https://api.anthropic.com"):g==="openrouter"&&await B("https://openrouter.ai");const w={provider:g,selectedModel:N,apiKey:k||void 0,ollamaEndpoint:"http://localhost:11434",hardwareProfile:l,benchmark:null,contextLength:8192,setupComplete:!0};await chrome.storage.local.set({setupConfig:w}),t()}const U=g==="ollama"?i||v.trim():i&&k.trim();return e.jsxs("div",{className:"w-[400px] min-h-[500px] bg-gray-950 text-white flex flex-col",children:[e.jsxs("div",{className:"px-4 pt-4 pb-3 border-b border-gray-800",children:[e.jsxs("h1",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx("img",{src:"/logo.webp",alt:"",className:"w-6 h-6 rounded"}),"OpenLens Setup"]}),e.jsx("div",{className:"flex gap-1.5 mt-2",children:I.map((N,w)=>e.jsx("div",{className:`h-1 flex-1 rounded transition-all ${s===N?"bg-blue-500":w<I.indexOf(s)?"bg-blue-800":"bg-gray-800"}`},N))})]}),e.jsxs("div",{className:"flex-1 overflow-auto p-4",children:[s==="scanning"&&e.jsx(ee,{hardware:l,ollamaReady:d,scanning:R,onNext:()=>n("model")}),s==="model"&&e.jsx(te,{hardware:l,ollamaReady:d,catalogModels:p,installedModels:r,provider:g,onProviderChange:j,selectedModel:i,onSelectModel:b,customModel:v,onCustomModelChange:z,apiKey:k,onApiKeyChange:T,canFinish:!!U,onNext:()=>n("ready"),onBack:()=>n("scanning")}),s==="ready"&&e.jsx(le,{provider:g,selectedModel:v||i,catalogModels:p,onFinish:_,onBack:()=>n("model")})]})]})}function ee({hardware:t,ollamaReady:s,scanning:n,onNext:l}){if(n)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 gap-4",children:[e.jsx("div",{className:"text-lg animate-pulse text-blue-400",children:"Scanning..."}),e.jsx("div",{className:"text-lg font-medium",children:"Scanning your hardware..."}),e.jsx("div",{className:"text-sm text-gray-400",children:"Let's see what your machine can do"})]});const a=t,d=Q(a);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center mb-2",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Hardware Scan"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Let's see what your machine can do"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(C,{icon:"",label:"CPU",value:`${a.cpuCores} cores`,ok:a.cpuCores>=2}),e.jsx(C,{icon:"",label:"RAM",value:a.ramGB?`${a.ramGB} GB`:"N/A",ok:a.ramGB>=4}),e.jsx(C,{icon:"",label:"GPU",value:a.gpuVendor!=="unknown"?a.gpuDevice.slice(0,20):"Not detected",ok:a.gpuVendor!=="unknown"}),e.jsx(C,{icon:"",label:"VRAM",value:a.vramEstimateGB?`~${a.vramEstimateGB} GB`:"N/A",ok:a.vramEstimateGB>=4}),e.jsx(C,{icon:"",label:"Storage",value:`${a.storageAvailableGB} GB`,ok:a.storageAvailableGB>1}),e.jsx(C,{icon:"",label:"Ollama",value:s?"Detected":"Not found",ok:s})]}),e.jsxs("div",{className:`p-3 rounded-lg text-center text-sm ${d?"bg-green-900/30 border border-green-800/30":"bg-yellow-900/30 border border-yellow-800/30"}`,children:[e.jsx("div",{className:`font-medium ${d?"text-green-300":"text-yellow-300"}`,children:d?"Your machine can run AI locally.":"Limited hardware â€” cloud models recommended."}),d&&e.jsx("div",{className:"text-xs text-green-400/70 mt-1",children:"Your data stays on YOUR device."})]}),e.jsx("button",{onClick:l,className:"w-full py-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium text-sm transition-colors",children:"Choose a Model â†’"})]})}function C({icon:t,label:s,value:n,ok:l}){return e.jsxs("div",{className:"bg-gray-900 rounded-lg p-2.5 relative",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[t&&e.jsx("span",{children:t})," ",s]}),e.jsx("div",{className:"text-sm font-medium truncate",children:n}),e.jsx("div",{className:`absolute top-2 right-2 text-xs ${l?"text-green-400":"text-gray-600"}`,children:l?"âœ“":"â€“"})]})}function te({hardware:t,ollamaReady:s,catalogModels:n,installedModels:l,provider:a,onProviderChange:d,selectedModel:x,onSelectModel:r,customModel:o,onCustomModelChange:c,apiKey:m,onApiKeyChange:p,canFinish:h,onNext:g,onBack:j}){const[i,b]=u.useState(s?"local":"cloud"),[v,z]=u.useState(!1);u.useEffect(()=>{i==="local"&&d("ollama")},[i]);const k=n.filter(y=>y.compatibility!=="incompatible"),T=n.filter(y=>y.compatibility==="incompatible"),R=v?n:k;return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:j,className:"text-gray-500 hover:text-white text-sm",children:"â†"}),e.jsx("h2",{className:"font-semibold text-lg",children:"Choose Your Model"})]}),e.jsxs("div",{className:"flex bg-gray-900 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>b("local"),className:`flex-1 py-1.5 rounded text-sm font-medium transition-colors ${i==="local"?"bg-green-700 text-white":"text-gray-400 hover:text-white"}`,children:"Local (Ollama)"}),e.jsx("button",{onClick:()=>b("cloud"),className:`flex-1 py-1.5 rounded text-sm font-medium transition-colors ${i==="cloud"?"bg-red-700 text-white":"text-gray-400 hover:text-white"}`,children:"Cloud (API Key)"})]}),i==="local"&&e.jsx(se,{ollamaReady:s,catalogModels:R,selectedModel:x,onSelectModel:y=>{r(y),c("")},customModel:o,onCustomModelChange:y=>{c(y),r("")},showAll:v,onToggleAll:()=>z(!v),incompatibleCount:T.length}),i==="cloud"&&e.jsx(ne,{provider:a,onProviderChange:d,selectedModel:x,onSelectModel:r,apiKey:m,onApiKeyChange:p}),e.jsx("button",{onClick:g,disabled:!h,className:"w-full py-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium text-sm disabled:opacity-40 disabled:cursor-not-allowed transition-colors",children:"Continue â†’"})]})}function se({ollamaReady:t,catalogModels:s,selectedModel:n,onSelectModel:l,customModel:a,onCustomModelChange:d,showAll:x,onToggleAll:r,incompatibleCount:o}){return t?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Select a model â€” compatibility checked against your hardware"}),e.jsx("div",{className:"max-h-[220px] overflow-auto space-y-1.5 pr-1",children:s.map(c=>e.jsx(ae,{model:c,selected:n===c.catalog.id,onSelect:()=>l(c.catalog.id)},c.catalog.id))}),o>0&&e.jsxs("button",{onClick:r,className:"text-xs text-gray-500 hover:text-gray-300",children:[x?"Hide":`Show ${o}`," incompatible models"]}),e.jsxs("div",{className:"pt-1 border-t border-gray-800",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Or enter any Ollama model name:"}),e.jsx("input",{type:"text",value:a,onChange:c=>d(c.target.value),placeholder:"e.g. codellama:7b, solar:10.7b ...",className:"w-full bg-gray-900 border border-gray-700 rounded px-3 py-2 text-sm focus:outline-none focus:border-blue-500 placeholder-gray-600"}),a&&e.jsxs("div",{className:"text-xs text-yellow-400 mt-1",children:["Make sure this model is pulled: ",e.jsxs("code",{className:"bg-gray-900 px-1 rounded",children:["ollama pull ",a]})]})]})]}):e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-800/30 rounded-lg p-3 text-sm",children:[e.jsx("div",{className:"font-medium text-yellow-300 mb-1",children:"Ollama not detected"}),e.jsx("div",{className:"text-yellow-200/80 text-xs",children:"Install Ollama for local AI processing:"}),e.jsx("code",{className:"block mt-1.5 bg-gray-900 rounded px-2 py-1 text-xs text-blue-400",children:"curl -fsSL https://ollama.com/install.sh | sh"}),e.jsx("div",{className:"text-yellow-200/80 text-xs mt-1.5",children:"Then pull a model:"}),e.jsx("code",{className:"block mt-1 bg-gray-900 rounded px-2 py-1 text-xs text-green-400",children:"ollama pull llama3.1:8b"})]})})}function ae({model:t,selected:s,onSelect:n}){const l=t.catalog,a=t.compatibility,d={compatible:"âœ“",tight:"~",incompatible:"âœ—"}[a],x={compatible:"text-green-400",tight:"text-yellow-400",incompatible:"text-red-400"}[a],r={compatible:"Compatible",tight:"Tight fit",incompatible:"Too large"}[a],o={open:"âœ“",restricted:"~","non-commercial":"âœ—"}[l.licenseType];return e.jsxs("button",{onClick:n,disabled:a==="incompatible",className:`w-full text-left p-2.5 rounded-lg transition-all ${s?"bg-blue-900/40 border border-blue-500":a==="incompatible"?"bg-gray-900/40 border border-transparent opacity-50 cursor-not-allowed":"bg-gray-900 border border-transparent hover:border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm",children:l.name}),t.installed&&e.jsx("span",{className:"text-[10px] bg-blue-900 text-blue-300 px-1.5 py-0.5 rounded",children:"installed"})]}),e.jsxs("span",{className:`text-xs ${x}`,children:[d," ",r]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-xs text-gray-400",children:[e.jsx("span",{children:l.parameterSize}),e.jsx("span",{children:"Â·"}),e.jsxs("span",{children:[l.sizeGB,"GB"]}),e.jsx("span",{children:"Â·"}),e.jsxs("span",{children:[o," ",l.license]})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:t.compatibilityReason}),!t.installed&&a!=="incompatible"&&e.jsx("code",{className:"block mt-1 text-[10px] text-green-400/70 bg-gray-800 rounded px-1.5 py-0.5 w-fit",children:l.pullCommand})]})}function ne({provider:t,onProviderChange:s,selectedModel:n,onSelectModel:l,apiKey:a,onApiKeyChange:d}){const x=["openai","anthropic","openrouter"];return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-red-900/15 border border-red-800/20 rounded-lg p-2.5 text-xs text-red-300",children:"Cloud: your data will leave your device. OpenLens will track exactly what is sent."}),e.jsx("div",{className:"space-y-1.5",children:x.map(r=>e.jsxs("button",{onClick:()=>{s(r),l(S[r].defaultModels[0]||"")},className:`w-full text-left p-2.5 rounded-lg transition-colors ${t===r?"bg-blue-900/40 border border-blue-500":"bg-gray-900 border border-transparent hover:border-gray-700"}`,children:[e.jsxs("div",{className:"font-medium text-sm",children:[S[r].icon," ",S[r].name]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-0.5",children:[r==="openai"&&"GPT-4o, GPT-4o-mini",r==="anthropic"&&"Claude Sonnet, Claude Haiku",r==="openrouter"&&"200+ models (free tier available)"]})]},r))}),t!=="ollama"&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"password",value:a,onChange:r=>d(r.target.value),placeholder:`${S[t].name} API key`,className:"w-full bg-gray-900 border border-gray-700 rounded px-3 py-2 text-sm focus:outline-none focus:border-blue-500"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-gray-400",children:"Model"}),S[t].defaultModels.map(r=>e.jsx("button",{onClick:()=>l(r),className:`w-full text-left p-2 rounded text-sm ${n===r?"bg-blue-900/40 border border-blue-500":"bg-gray-900 border border-transparent hover:border-gray-700"}`,children:r},r)),e.jsx("input",{type:"text",value:n,onChange:r=>l(r.target.value),placeholder:"Or type a custom model ID...",className:"w-full bg-gray-900 border border-gray-700 rounded px-3 py-2 text-sm focus:outline-none focus:border-blue-500"})]})]})]})}function le({provider:t,selectedModel:s,catalogModels:n,onFinish:l,onBack:a}){const d=t==="ollama",x=n.find(r=>r.catalog.id===s);return e.jsxs("div",{className:"space-y-4 flex flex-col items-center justify-center h-full",children:[e.jsx("h2",{className:"font-semibold text-xl",children:"Ready to Go"}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 w-full space-y-2.5",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Provider"}),e.jsx("span",{children:d?"Ollama (Local)":S[t].name})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Model"}),e.jsx("span",{className:"font-medium",children:s})]}),x&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Size"}),e.jsxs("span",{children:[x.catalog.sizeGB,"GB Â· ",x.catalog.parameterSize]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"License"}),e.jsx("span",{children:x.catalog.license})]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Privacy"}),e.jsx("span",{className:d?"text-green-400":"text-red-400",children:d?"Data stays on device":"Data sent to cloud"})]})]}),e.jsx("p",{className:"text-sm text-gray-400 text-center",children:"OpenLens will monitor AI activity and show you what your AI knows about you."}),e.jsx("button",{onClick:l,className:"w-full py-3 bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold text-base transition-colors",children:"Start OpenLens"}),e.jsx("button",{onClick:a,className:"text-xs text-gray-500 hover:text-gray-300",children:"â† Change model"})]})}function ie(t){const s={};for(const n of t)s[n.category]||(s[n.category]=[]),s[n.category].push(n);return s}function re(){const[t,s]=u.useState(null),[n,l]=u.useState(!0);u.useEffect(()=>{a();const m=p=>{p.shadowProfile&&s(p.shadowProfile.newValue)};return chrome.storage.onChanged.addListener(m),()=>chrome.storage.onChanged.removeListener(m)},[]);function a(){chrome.storage.local.get("shadowProfile",m=>{s(m?.shadowProfile||null),l(!1)})}function d(){chrome.storage.local.remove("shadowProfile",()=>{s(null)})}function x(){if(!t)return;const m=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),p=URL.createObjectURL(m),h=document.createElement("a");h.href=p,h.download=`openlens-shadow-profile-${new Date().toISOString().slice(0,10)}.json`,h.click(),URL.revokeObjectURL(p)}function r(){l(!0),(typeof L<"u"?L.runtime.sendMessage.bind(L.runtime):chrome.runtime.sendMessage.bind(chrome.runtime))({type:"GENERATE_SHADOW_PROFILE"}).then(()=>{setTimeout(a,1e3)}).catch(()=>l(!1))}if(n)return e.jsx("div",{className:"text-gray-400 text-sm text-center py-8",children:"Loading..."});if(!t||t.inferences.length===0)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-3 text-center",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"No Shadow Profile Yet"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Run a task through the Agent Panel to see what your AI infers about you."}),e.jsx("button",{onClick:r,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded text-sm mt-2",children:"Generate from current session"})]});const o=ie(t.inferences),c={financial:"Financial",schedule:"Schedule",preferences:"Preferences",relationships:"Relationships",habits:"Habits",work:"Work",location:"Location",health:"Health"};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-center mb-3",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["After ",t.sessionCount," session",t.sessionCount!==1?"s":"",", your AI has inferred:"]}),e.jsxs("div",{className:"text-2xl font-bold text-purple-400 mt-1",children:[t.inferences.length," data points"]})]}),Object.entries(o).map(([m,p])=>e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsxs("h4",{className:"font-semibold text-sm mb-2 flex items-center gap-2",children:[e.jsx("span",{children:p[0]?.icon}),e.jsx("span",{className:"uppercase text-xs tracking-wide text-gray-300",children:c[m]||m})]}),e.jsx("div",{className:"space-y-2",children:p.map((h,g)=>e.jsx("div",{className:"text-sm",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"Â·"}),e.jsxs("div",{children:[e.jsx("span",{children:h.inference}),e.jsxs("span",{className:`ml-2 text-xs ${h.confidence==="high"?"text-green-400":h.confidence==="medium"?"text-yellow-400":"text-gray-500"}`,children:["(",h.confidence,")"]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:["â†³ ",h.derivedFrom.join(", ")]})]})]})},g))})]},m)),e.jsxs("div",{className:"bg-green-900/20 rounded-lg p-3 text-center text-sm text-green-300",children:["All inferences derived from LOCAL processing.",e.jsx("br",{}),"Nothing left your device."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:d,className:"flex-1 py-2 bg-red-900/30 hover:bg-red-900/50 text-red-300 rounded text-sm",children:"Clear"}),e.jsx("button",{onClick:x,className:"flex-1 py-2 bg-gray-800 hover:bg-gray-700 rounded text-sm",children:"Export"})]})]})}const oe=[{name:"read_page",description:"Extract and summarize the current page content"},{name:"extract_data",description:"Extract structured data (prices, links, forms, headings)"},{name:"find_on_page",description:"Search for specific text on the page"},{name:"navigate",description:"Open a URL in a new tab"},{name:"fill_form",description:"Fill form fields (user must submit)"},{name:"click_element",description:"Click a link or button"}],P=typeof L<"u"?L.runtime.sendMessage.bind(L.runtime):chrome.runtime.sendMessage.bind(chrome.runtime);function ce(){const[t,s]=u.useState([]),[n,l]=u.useState(!1),[a,d]=u.useState("http://localhost:3001"),[x,r]=u.useState(!1),[o,c]=u.useState(null);u.useEffect(()=>{m()},[]);function m(){P({type:"GET_MCP_SERVERS"}).then(i=>{s(i?.servers||[])}).catch(()=>{})}async function p(){if(a.trim()){r(!0),c(null);try{if(!await B(a.trim())){c("Permission denied â€” OpenLens needs access to reach this server"),r(!1);return}const b=await P({type:"CONNECT_MCP_SERVER",url:a.trim()});b?.ok?(l(!1),d("http://localhost:3001"),m()):c(b?.error||"Connection failed")}catch(i){c(String(i))}r(!1)}}async function h(i){await P({type:"DELETE_MCP_SERVER",serverId:i}),m()}async function g(i){await P({type:"TOGGLE_MCP_SERVER",serverId:i}),m()}const j=t.filter(i=>i.enabled).reduce((i,b)=>i+(b.tools?.length||0),0);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:"Built-in Page Tools (6)"}),e.jsx("div",{className:"space-y-1",children:oe.map(i=>e.jsxs("div",{className:"flex items-center gap-2 text-xs py-1.5 px-2 bg-gray-900/50 rounded",children:[e.jsx("span",{className:"text-green-400 text-[10px]",children:"âœ“"}),e.jsx("span",{className:"font-medium text-gray-300",children:i.name}),e.jsx("span",{className:"text-gray-500 truncate",children:i.description})]},i.name))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:["MCP Servers (",t.length,") ",j>0&&e.jsxs("span",{className:"text-green-400",children:["â€” ",j," tools"]})]}),e.jsx("button",{onClick:()=>l(!n),className:"text-xs px-2 py-1 bg-blue-600 hover:bg-blue-700 rounded",children:n?"Cancel":"+ Connect Server"})]}),n&&e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 space-y-2 mb-3 border border-gray-700",children:[e.jsxs("div",{className:"text-xs text-gray-400 mb-1",children:["Enter the URL of an MCP-compatible tool server.",e.jsx("br",{}),"Example: ",e.jsx("code",{className:"text-blue-400",children:"http://localhost:3001"})]}),e.jsx("input",{placeholder:"http://localhost:3001",value:a,onChange:i=>d(i.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded px-2 py-1.5 text-sm focus:outline-none focus:border-blue-500 font-mono"}),o&&e.jsx("div",{className:"text-xs text-red-400",children:o}),e.jsx("button",{onClick:p,disabled:x,className:`w-full py-1.5 rounded text-sm font-medium ${x?"bg-gray-700 text-gray-400":"bg-green-600 hover:bg-green-700"}`,children:x?"Connecting...":"Connect & Discover Tools"}),e.jsxs("div",{className:"text-[10px] text-gray-600 leading-tight",children:["Try the demo weather server: ",e.jsx("code",{children:"node mcp-servers/weather-server.js"})]})]}),t.length===0&&!n&&e.jsx("div",{className:"text-xs text-gray-500 text-center py-4",children:"No MCP servers connected. Connect one to give your AI new tools."}),t.map(i=>e.jsxs("div",{className:"bg-gray-900 rounded-lg p-2.5 mb-2 border border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>g(i.id),className:"shrink-0",children:i.enabled?e.jsx("span",{className:"text-green-400 text-xs",children:"â—"}):e.jsx("span",{className:"text-gray-600 text-xs",children:"â—‹"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-sm text-gray-200",children:i.name}),e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${i.status==="connected"?"bg-green-900/40 text-green-400":i.status==="error"?"bg-red-900/40 text-red-400":"bg-gray-800 text-gray-500"}`,children:i.status})]}),e.jsx("div",{className:"text-[10px] text-gray-500 font-mono truncate",children:i.url})]}),e.jsx("button",{onClick:()=>h(i.id),className:"shrink-0 text-red-400 hover:text-red-300 text-sm",children:"Ã—"})]}),i.tools&&i.tools.length>0&&e.jsx("div",{className:"mt-2 pl-6 space-y-0.5",children:i.tools.map(b=>e.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[e.jsx("span",{className:"text-blue-400 text-[10px]",children:"T"}),e.jsx("span",{className:"text-gray-300 font-medium",children:b.name}),e.jsx("span",{className:"text-gray-500 truncate",children:b.description})]},b.name))})]},i.id))]})]})}function de(){const[t,s]=u.useState("loading");return u.useEffect(()=>{chrome.storage.local.get("setupConfig",n=>{n.setupConfig?.setupComplete?s("main"):s("setup")})},[]),t==="loading"?e.jsx("div",{className:"w-[400px] h-[500px] bg-gray-950 text-white flex items-center justify-center",children:e.jsx("div",{className:"text-lg animate-pulse",children:"Loading..."})}):t==="setup"?e.jsx(Z,{onComplete:()=>s("main")}):e.jsx(me,{})}function me(){const[t,s]=u.useState("dashboard");return e.jsxs("div",{className:"w-[400px] h-[500px] bg-gray-950 text-white flex flex-col",children:[e.jsxs("div",{className:"px-4 pt-4 pb-2 border-b border-gray-800",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-lg font-bold flex items-center gap-2",children:[e.jsx("img",{src:"/logo.webp",alt:"",className:"w-6 h-6 rounded"}),"OpenLens"]}),e.jsx("button",{onClick:()=>{chrome.storage.local.remove("setupConfig"),window.location.reload()},className:"text-xs text-gray-500 hover:text-gray-300",children:"Reset"})]}),e.jsxs("div",{className:"flex gap-1 mt-3",children:[e.jsx("button",{onClick:()=>s("dashboard"),className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${t==="dashboard"?"bg-blue-600 text-white":"text-gray-400 hover:text-white"}`,children:"Dashboard"}),e.jsx("button",{onClick:()=>s("shadow"),className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${t==="shadow"?"bg-purple-600 text-white":"text-gray-400 hover:text-white"}`,children:"Shadow Profile"}),e.jsx("button",{onClick:()=>s("tools"),className:`px-3 py-1.5 rounded text-sm font-medium transition-colors ${t==="tools"?"bg-green-600 text-white":"text-gray-400 hover:text-white"}`,children:"MCP"})]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:t==="dashboard"?e.jsx(xe,{}):t==="shadow"?e.jsx(re,{}):e.jsx(ce,{})})]})}function xe(){const[t,s]=u.useState(null),[n,l]=u.useState(null);u.useEffect(()=>{chrome.storage.local.get(["setupConfig","sessionState"],c=>{s(c.setupConfig),l(c.sessionState)});const o=c=>{c.sessionState&&l(c.sessionState.newValue)};return chrome.storage.onChanged.addListener(o),()=>chrome.storage.onChanged.removeListener(o)},[]);const a=t?.hardwareProfile,d=n?.totalTokens||0,x=n?.auditEvents?.length||0,r=n?Math.round(n.contextUsed/n.contextLimit*100):0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Active Model"}),e.jsx("div",{className:"font-semibold",children:t?.selectedModel||"None"}),e.jsx("div",{className:`text-xs mt-1 ${t?.provider==="ollama"?"text-green-400":"text-red-400"}`,children:t?.provider==="ollama"?"ðŸŸ¢ Local processing":`ðŸ”´ Cloud â€” ${t?.provider||"unknown"}`})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx($,{label:"Tokens",value:d.toLocaleString(),icon:"ðŸ“Š"}),e.jsx($,{label:"Context",value:`${r}%`,icon:"ðŸ§ ",color:r>90?"red":r>70?"yellow":"green"}),e.jsx($,{label:"Events",value:String(x),icon:"ðŸ“‹"})]}),a&&e.jsxs("div",{className:"bg-gray-900 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-2",children:"Hardware"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-xs",children:[e.jsxs("div",{children:["CPU: ",a.cpuCores," cores"]}),e.jsxs("div",{children:["RAM: ",a.ramGB,"GB"]}),e.jsxs("div",{children:["GPU: ",a.gpuVendor]}),e.jsxs("div",{children:["Storage: ",a.storageAvailableGB,"GB"]})]})]}),e.jsx("button",{onClick:()=>{chrome.runtime.sendMessage({type:"OPEN_SIDEPANEL"})},className:"w-full py-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg font-medium text-sm transition-colors",children:"Open Panel"})]})}function $({label:t,value:s,icon:n,color:l="blue"}){const a={blue:"text-blue-400",green:"text-green-400",yellow:"text-yellow-400",red:"text-red-400"};return e.jsxs("div",{className:"bg-gray-900 rounded-lg p-2.5 text-center",children:[n&&e.jsx("div",{className:"text-base",children:n}),e.jsx("div",{className:`font-bold text-lg ${a[l]||a.blue}`,children:s}),e.jsx("div",{className:"text-xs text-gray-400",children:t})]})}F.createRoot(document.getElementById("root")).render(e.jsx(K.StrictMode,{children:e.jsx(de,{})}));
